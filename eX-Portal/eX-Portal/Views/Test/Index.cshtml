@model eX_Portal.exLogic.GeoGrid
  <div id="cord"></div>
  <div id="map_canvas" style="width: 100%; height: 480px;"></div>

  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  
@section scripts {
  <script type="text/javascript">
    var map = null;
    $(document).ready(function () {
      initialize();
      drawGrids();
    });

    function initialize() {
      // map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

      var TheInfo = @Html.Raw(Model.getBox());
      var myLatLng =  {lat: TheInfo["TopLeftLat"], lng: TheInfo["TopLeftLon"]};
      var mapDiv = document.getElementById('map_canvas');
      map = new google.maps.Map(mapDiv, {
        center: myLatLng,
        zoom: 18
      });

      var triangleCoords = [
        {lat: TheInfo["TopLeftLat"], lng: TheInfo["TopLeftLon"]},
        {lat: TheInfo["TopRightLat"], lng: TheInfo["TopRightLon"]},
        {lat: TheInfo["BottomRightLat"], lng: TheInfo["BottomRightLon"]},
        {lat: TheInfo["BottomLeftLat"], lng: TheInfo["BottomLeftLon"]}
      ];
      // Construct the polygon.
      var theBox = new google.maps.Polygon({
        paths: triangleCoords,
        strokeColor: '#FF0000',
        strokeOpacity: 0.7,
        strokeWeight: 1,
        fillColor: '#FF0000',
        fillOpacity: 0.1
      });
      theBox.setMap(map);

      //Add listener
      google.maps.event.addListener(theBox, "click", function (event) {
        var latitude = event.latLng.lat();
        var longitude = event.latLng.lng();
        console.log( latitude + ', ' + longitude )

      }); //end addListener


      radius = new google.maps.Circle({map: map,
        radius: .5,
        center: myLatLng,
        fillColor: '#777',
        fillOpacity: 0.1,
        strokeColor: '#AA0000',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        draggable: true,    // Dragable
      });

      google.maps.event.addListener(radius, 'center_changed', function(event) {
        $('#cord').html(radius.center.lat() + ", " + radius.center.lng());
      });


      //drawGridLines();


      //GetDrones();
    };

    function drawGridLines() {
      var Lines = [
        @Html.Raw(Model.getRowLines()),
        @Html.Raw(Model.getColumnLines())
      ];


      for(var i = 0; i < Lines.length; i++) {
        var Color = '#000000';
        var lineCoordinates = [
            {lat:Lines[i]["sLat"], lng: Lines[i]["sLon"]},
            {lat:Lines[i]["eLat"], lng: Lines[i]["eLon"]}
        ];
        var line = new google.maps.Polyline({
          path: lineCoordinates,
          geodesic: true,
          strokeColor: Color,
          strokeOpacity: 0.4,
          strokeWeight: 1
        });
        line.setMap(map);
      }
    }


    function drawGrids() {
      var Cords = [
        @Html.Raw(Model.getCords())
      ];
      for(var i = 0; i < Cords.length; i++) {
        var theBox = [
          {lat: Cords[i]["TopLeftLat"], lng: Cords[i]["TopLeftLon"]},
          {lat: Cords[i]["TopRightLat"], lng: Cords[i]["TopRightLon"]},
          {lat: Cords[i]["BottomRightLat"], lng: Cords[i]["BottomRightLon"]},
          {lat: Cords[i]["BottomLeftLat"], lng: Cords[i]["BottomLeftLon"]}
        ];
        // Construct the polygon.
        var Color = getRandomColor();
        var Poly = new google.maps.Polygon({
          paths: theBox,
          strokeColor: Color,
          strokeOpacity: 0.8,
          strokeWeight: 0,
          fillColor: Color,
          fillOpacity: 0.8
        });
        Poly.setMap(map);
      }
    }

    function getRandomColor() {
      var letters = '0123456789ABCDEF'.split('');
      var color = '#';
      for (var i = 0; i < 6; i++ ) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

  </script>
}
