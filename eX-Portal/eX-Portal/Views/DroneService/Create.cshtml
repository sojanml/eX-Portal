@model eX_Portal.ViewModel.DroneServiceViewModel
@{
    ViewBag.Title = "UAS Service";
    Layout = "~/Views/Shared/_exPortal.cshtml";
}
<script src="~/Scripts/bootstrap.js"></script>
<section class="general-form">
    @using (Html.BeginForm())
    {

  

        @Html.HiddenFor(model => model.DroneService.ServiceId)

        <div class="editor-label">
            @Html.LabelFor(model => model.DroneService.DroneId, "UAV Name")
        </div>
        <div class="editor-field">

            @Html.DropDownListFor(model => model.DroneID, Model.DroneList,"Select Item",
            new { @class = "form-control", @onchange="FillParts()" })

        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.DroneService.TypeOfService, "Service Type")
        </div>
        <div class="editor-field">

            @Html.DropDownListFor(model => model.DroneService.TypeOfService, Model.ServiceType)

        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.DroneParts.PartsName, "Parts Refurbished")
        </div>
        <div class="editor-field">

            @Html.ListBoxFor(model => model.SelectItemsForRefurbished,
       new SelectList(Enumerable.Empty<SelectListItem>(), "PartsId", "PartsName"),
             
              new { @class = "form-control" })
           
        </div>


        <div class="editor-label">
            @Html.LabelFor(model => model.DroneParts.PartsName, "Parts Replaced")
        </div>
        <div class="editor-field">

            @Html.ListBoxFor(model => model.SelectItemsForReplaced,
       new SelectList(Enumerable.Empty<SelectListItem>(), "PartsId", "PartsName"),

              new { @class = "form-control" })

        </div>


        <div class="editor-label">
            @Html.LabelFor(model => model.DroneService.Description, "Description")
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.DroneService.Description, 10, 55, null)

        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.DroneService.FlightHour, "Flight Hour")
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.DroneService.FlightHour)

        </div>


        <div class="editor-label">
            @Html.LabelFor(model => model.DroneService.DateOfService, "Date Of Service")
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.DroneService.DateOfService, new { htmlAttributes = new { @class = "date-picker" } })
            @Html.ValidationMessageFor(model => model.DroneService.DateOfService)
        </div>

       
        <div class="form-toolbar">
            <input type="submit" value="Create" />
        </div>
    }
</section>

@section Scripts {
    <script>
  function FillParts() {
      var droneId = $('#DroneID').val();
      $.ajax({
          url: '/DroneService/FillParts',
          type: "GET",
          dataType: "JSON",
          data: { DroneId: droneId },
          success: function (cities) {
              $("#SelectItemsForRefurbished").html(""); // clear before appending new list 
              $("#SelectItemsForReplaced").html("");// clear before appending new list 
              $.each(cities, function (i, city) {
                  $("#SelectItemsForRefurbished").append(
                      $('<option></option>').val(city.PartsId).html(city.PartsName + "-" + city.Model));
                  $("#SelectItemsForReplaced").append(
                     $('<option></option>').val(city.PartsId).html(city.PartsName + "-" + city.Model));
              });
           
          }
      });


    
  }
    </script>
}